---
title: Medford MA covid information
output:
  html_document:
    includes:
       in_header: GA_Script.html
params:
  sumtab: "unknown"
---

The purpose of this is to gather information on how the covid-19 pandemic is progressing in Medford, MA. It is **not** an official site; please go to https://www.medfordma.org/coronavirus-information/ for official information.

I am mostly doing this for the convenience of my family who live in Medford -- they wanted to see plots of things like positivity rate over time. 

Please keep my family, and yours, and yourself safe by following public health guidelines. Find a vaccine at https://vaxfinder.mass.gov/ and go [here](https://www.medfordma.org/coronavirus-information/) for info on boosters, masking, and more.


```{r, echo=FALSE, message=FALSE, warning=FALSE}
source("_packages.R")
source("R/functions.R")
tar_load(medford_from_state)
tar_load(medford_from_city)
tar_load(hhs_capacity_ma)
tar_load(hhs_capacity_ma_focal)
tar_load(hhs_capacity_ma_focal_latest_pretty)
```

Positivity rates (what percent of tests show covid; if this is high, it could indicate that many other cases are being missed).

```{r, echo=FALSE, message=FALSE, warning=FALSE}	
plot_positivity <- ggplot(medford_from_state, aes(x=End_Date, y=Percent_Positivity)) + geom_line()+ theme_light() + xlab("Date") + ylab("Positivity rate of tests for the week ending this date")
print(plot_positivity)
```

New covid cases per day in Medford

```{r, echo=FALSE, message=FALSE, warning=FALSE}	
plot_cases <- ggplot(medford_from_city, aes(x=DATE, y=`New Cases`)) + geom_line()+ theme_light() + xlab("Date") + ylab("Number of new cases per day")
print(plot_cases)
```

### Hospital data


The US Department of Health and Human Services gives data on hospital usage. Here are data for hospitals in this area.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(hhs_capacity_ma_focal_latest_pretty)
```


Plotting percentage of ICU patients with covid over time. Some hospitals have much more frequently updated data than others; some is fairly gappy. This just plots the hospitals that average with at least 50 ICU beds per week.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
major_hospitals <- subset(hhs_capacity_ma_focal, total_icu_beds_7_day_avg>=50)
try(hospital_plot <- ggplot(major_hospitals, aes(x=DATE, y=percentage_adult_hospital_inpatient_ICU_bed_occupied_of_all_inpatient_ICU_beds)) + geom_line(aes(colour=hospital_name)) + theme_light() + ylab("Percent of ICU patients witth covid") + xlab("Date") + ggtitle("Percent of ICU patients with covid") + ylim(c(50, 100)) )
print(hospital_plot)
```
